1
00:00:00,669 --> 00:00:03,673
嗨！欢迎來到本周的视频。 今天

2
00:00:03,709 --> 00:00:07,940
我们要说说数组公式 。 我们有一个全新的

3
00:00:07,940 --> 00:00:11,360
例子来演示数组公式 。 在本周的例子中

4
00:00:11,360 --> 00:00:14,429
我们扮演一名教师。 而这是个很棒的巧合，当然是因为

5
00:00:14,469 --> 00:00:17,088
我是一名教师，这实际上是一个

6
00:00:17,088 --> 00:00:22,047
我如何分析考试成绩的真实经验。 因此，让我们在本周的视频

7
00:00:22,047 --> 00:00:23,064
看看我们要处理的电子表格。 

8
00:00:23,064 --> 00:00:27,344
它与在我的班上的一群同学

9
00:00:27,349 --> 00:00:30,869
有关。 我有他们的学号，名字

10
00:00:30,900 --> 00:00:33,360
和入学年份。

11
00:00:33,860 --> 00:00:38,000
姓名，ID和他们开始入学的年份。

12
00:00:38,003 --> 00:00:41,920
除此之外，我有考试结果，所以你看到

13
00:00:41,920 --> 00:00:42,980
我有许多疑问，

14
00:00:42,980 --> 00:00:47,039
我有学生名单，然后我的问题是

15
00:00:47,041 --> 00:00:53,340
我有满分分数和与所有学生的分数。 你可能认为我

16
00:00:53,340 --> 00:00:54,229
会用这个

17
00:00:54,239 --> 00:00:58,579
电子表格来为学生分析分数，

18
00:00:58,640 --> 00:01:02,012
但事实并非如此。 我也用考试结果作为

19
00:01:02,012 --> 00:01:06,512
分析考试质量的方法。 所以我在看结果也

20
00:01:06,520 --> 00:01:09,539
看哪个问题

21
00:01:09,549 --> 00:01:13,031
最影响考试分数。 让我给你举一个例子。

22
00:01:13,031 --> 00:01:17,411
从电子表格可以看出，问题1和2的

23
00:01:17,760 --> 00:01:22,020
答案是非常相似的。 在许多情况下，会有相同的分数

24
00:01:22,021 --> 00:01:26,460
或非常相似分数。 所以，如果我想深入探讨，

25
00:01:26,460 --> 00:01:27,860
我当然是使用SUM（）

26
00:01:27,869 --> 00:01:31,299
计算这一个问题的所有分数

27
00:01:31,299 --> 00:01:35,479
和SUM（）计算另一问题的所有分数，然后互相比较。 我可以

28
00:01:35,480 --> 00:01:36,020
看到

29
00:01:36,020 --> 00:01:40,000
确实问题1和2之间的差别并不是那么大。

30
00:01:40,000 --> 00:01:42,680
不过就是有点误导性，

31
00:01:42,689 --> 00:01:46,159
因为你看这，如果我只对这些单元格使用SUM()函数

32
00:01:46,159 --> 00:01:50,014
总和将是相同的，但是答案将是非常不同的。

33
00:01:50,014 --> 00:01:53,814
因此，SUM()并不是一个真正了解

34
00:01:53,829 --> 00:01:58,053
这两个问题有何不同的好办法。 那么怎么办？

35
00:01:58,053 --> 00:02:01,085
我其实想做的是

36
00:02:01,085 --> 00:02:05,745
在这两个问题的所有单元格、所有结果中找出不同来。

37
00:02:05,860 --> 00:02:10,229
让我这样试一试，不幸的是，双击现在不起作用了，

38
00:02:10,229 --> 00:02:13,026
因为有一个空白列，所以我得把

39
00:02:13,026 --> 00:02:17,459
公式拖下来，然后我就可以看到 所有的单元格之间的差值。

40
00:02:17,459 --> 00:02:21,779
但正如你所看到的，有些差值是正的，有些是负的，

41
00:02:21,800 --> 00:02:25,149
因此，我们需要对差值取绝对值

42
00:02:25,159 --> 00:02:28,029
以得到这两个问题之间的

43
00:02:28,029 --> 00:02:31,037
真正的差值。 于是我们把

44
00:02:31,037 --> 00:02:34,042
绝对差值拖下来，现在我们可以看到：

45
00:02:34,042 --> 00:02:37,882
哎，是真的有区别吗？ 如果我们这些值加在一起

46
00:02:38,018 --> 00:02:41,558
我们看到这两个问题之间的差异确实存在，

47
00:02:41,560 --> 00:02:44,080
且没有那么大。 总差值是21，

48
00:02:44,081 --> 00:02:48,961
而我们有14个学生，所以在那些问题中，每个学生的差值

49
00:02:49,002 --> 00:02:53,261
大约是1.5。 这帮到了我，

50
00:02:53,459 --> 00:02:57,012
这帮助我分析，因为 现在我知道这两个问题

51
00:02:57,012 --> 00:03:00,832
的相互关系。 不过，如果我不只有2个问题，而是12个。

52
00:03:01,000 --> 00:03:04,006
所以，如果我想重复这个来分析所有问题

53
00:03:04,006 --> 00:03:07,746
我得添加很多的辅助列，你看，

54
00:03:07,980 --> 00:03:12,620
几乎没有尽头。 这并不是我想要的。

55
00:03:12,780 --> 00:03:15,852
我希望你从之前的课上记住，复制

56
00:03:16,023 --> 00:03:20,803
并不是一件好事。
如果你正在一遍又一遍地做同样的事情，如果你正在

57
00:03:20,803 --> 00:03:22,001
添加很多相似的列，

58
00:03:22,001 --> 00:03:26,400
或者很多相似的行，你得想起我。 请你想起我，并想到：

59
00:03:26,400 --> 00:03:27,056


60
00:03:27,056 --> 00:03:31,816
“哦，不能复制！ 复制不好，我得回到MOOC

61
00:03:31,819 --> 00:03:35,004
去寻找一个更聪明的方式来做这件事。” 所以

62
00:03:35,004 --> 00:03:39,520
怎么样才是聪明的呢？ 让我先删除所有这些重复列

63
00:03:39,520 --> 00:03:42,980
我们不要这些，我们缩小了一点

64
00:03:42,980 --> 00:03:47,080
同时我们还要拿掉这个东西，因为我们准备以一个更紧凑，

65
00:03:47,080 --> 00:03:51,079
更聪明的方式来做这件事。 所以，我们想要做的事情

66
00:03:51,079 --> 00:03:54,084
是，一次性

67
00:03:54,300 --> 00:03:57,580
从问题2中减去问题1 而不要所有这些

68
00:03:57,669 --> 00:04:02,031
中间步骤。 所以这是一个很好的 尝试，我们只是

69
00:04:02,031 --> 00:04:06,059
从另一范围扣除一个范围。 让我们来看看有了evaluate函数

70
00:04:06,059 --> 00:04:11,019
現在这里究竟发生了什么。
我们有第一栏，如果我们evaluate它

71
00:04:11,019 --> 00:04:14,719
我们得到8，这是第一栏

72
00:04:14,720 --> 00:04:19,340
的项目。 这是因为 Excel现在计算的是交集，

73
00:04:19,349 --> 00:04:22,489
这个我们在前面的课程中谈过。

74
00:04:23,004 --> 00:04:27,264
因此这已经接近了我们想要的，但又不完全是我们想要的那样。
我们不需要Excel

75
00:04:27,340 --> 00:04:29,580
立刻计算交点，

76
00:04:29,700 --> 00:04:32,860
我们想要的是所有的差值

77
00:04:32,980 --> 00:04:36,025
而这个，你可能已经猜到这了

78
00:04:36,025 --> 00:04:40,945
正是数组公式进来的地方，因为 Excel可以以两种不同的方式

79
00:04:41,014 --> 00:04:44,394
评估这个函数。 让我告诉你另外一种

80
00:04:44,400 --> 00:04:47,940
方式是什么样子的。 刚刚这个可以说是标准，

81
00:04:48,008 --> 00:04:51,300
标准做法就是我们刚才做的 那样。

82
00:04:51,300 --> 00:04:54,040
我们将此公式粘贴

83
00:04:54,042 --> 00:04:57,920
进去，而现在的另一种方式，即做这件事的数组方式，

84
00:04:57,920 --> 00:05:01,860
我们不按回车，而是按control、shift和回车。

85
00:05:02,160 --> 00:05:05,780
如果我们这样做，我们不过得到了公式周围的一个漂亮的大括号

86
00:05:05,800 --> 00:05:08,720
这

87
00:05:08,960 --> 00:05:12,035
其实没什么意义，因为我们得到了同样的

88
00:05:12,035 --> 00:05:16,035
结果。 所以你可能会觉得没有什么 差别，大括号并

89
00:05:16,035 --> 00:05:19,895
不能做任何事。 然而计算的方式，

90
00:05:20,012 --> 00:05:23,712
真的已经不同了。 底下的东西

91
00:05:23,800 --> 00:05:27,920
已经不同了。 而为了让我们理解这两之间的区别

92
00:05:27,920 --> 00:05:28,640


93
00:05:28,640 --> 00:05:32,640
两个计算方法之间的区别，我们需要使用类型理论。

94
00:05:38,460 --> 00:05:41,020
在减函数的第一版，普通版本中，

95
00:05:41,026 --> 00:05:45,686
会发生如下情况：我们有范围

96
00:05:46,080 --> 00:05:49,640
B3到B16

97
00:05:50,340 --> 00:05:52,960
然后我们从中减去范围

98
00:05:52,960 --> 00:05:56,200
C3到C16。

99
00:05:57,400 --> 00:05:59,820
这里会发生的是减法，

100
00:05:59,820 --> 00:06:03,057
该两个范围的交集。 这是Excel所

101
00:06:03,057 --> 00:06:07,917
回传的范围，

102
00:06:08,340 --> 00:06:10,720
所以这是8，第一个交集減去10，

103
00:06:12,280 --> 00:06:15,080
第二交集

104
00:06:17,380 --> 00:06:19,280
的结果是

105
00:06:19,280 --> 00:06:22,040
在-2，这就是我们所看到的。 所以

106
00:06:22,045 --> 00:06:25,340
替代版本大括號、array版本發生了什麼，

107
00:06:25,340 --> 00:06:27,380


108
00:06:34,380 --> 00:06:35,460
它看起来

109
00:06:35,460 --> 00:06:39,720
完全一样，但是里面真的很不同。

110
00:06:41,160 --> 00:06:43,319
所以，在这个方案中，再次从

111
00:06:43,319 --> 00:06:47,119
B3到B16减去

112
00:06:47,380 --> 00:06:50,219
C3到C16。

113
00:06:54,640 --> 00:06:55,960
在数组方案中，

114
00:06:55,960 --> 00:07:00,080
没有减法发生。 Excel在整个范围内

115
00:07:00,129 --> 00:07:03,329
计算减法。 所以在内部

116
00:07:04,100 --> 00:07:07,660
我们有B3减C3

117
00:07:09,140 --> 00:07:10,800
然后B4

118
00:07:10,929 --> 00:07:14,909
减去C4，然后B5

119
00:07:15,380 --> 00:07:17,580
减去C5，

120
00:07:19,640 --> 00:07:22,120
我想你能想到剩下的情况。

121
00:07:22,340 --> 00:07:25,346
然后所有这些，都进行了

122
00:07:25,349 --> 00:07:29,429
减法计算，全部。 所以我们得到的列表中，

123
00:07:29,800 --> 00:07:34,460
就有8减10，0减0，

124
00:07:35,040 --> 00:07:39,400
5减去5等

125
00:07:40,420 --> 00:07:41,700
所以

126
00:07:41,709 --> 00:07:44,715
这个数组，这个大括号版的，公式的结果，

127
00:07:44,769 --> 00:07:47,689
是一个列表

128
00:07:51,200 --> 00:07:55,900
2，0，0等

129
00:07:56,180 --> 00:07:59,820
但因为Excel没有绘制整张列表的空间，

130
00:07:59,829 --> 00:08:02,870
我们仅有一个单元格，我们只得到了

131
00:08:03,239 --> 00:08:06,244
列表中的第一个数。

132
00:08:06,289 --> 00:08:09,295
但是，这并不表示结果是数字

133
00:08:09,349 --> 00:08:12,829
其结果实际上是一个列表。 它看起来相同

134
00:08:12,829 --> 00:08:16,749
但在本质上它是 不同的。 因此，让我们回去，

135
00:08:16,749 --> 00:08:22,609
看看这在Excell会如何。 我们再也不需要眼镜了。

136
00:08:26,340 --> 00:08:27,360
因此，如果我们看

137
00:08:27,360 --> 00:08:30,460
我们的电子表格 ，我们没有看到区别。

138
00:08:30,469 --> 00:08:34,349
但是在本质上是不同的。 第一个版本

139
00:08:34,349 --> 00:08:38,409
结果是一个数和第二 版本的结果是列表。

140
00:08:38,980 --> 00:08:42,980
因此，我们可以使用列表做什么？
我们有一个列表真的很棒，但是要做什么？

141
00:08:42,980 --> 00:08:43,540


142
00:08:43,540 --> 00:08:48,280
如何显示与使用列表來工作？ 因此，第一件我们可以用

143
00:08:48,280 --> 00:08:49,011
array函数做的事情，

144
00:08:49,011 --> 00:08:53,360
就是给它的空间。 在电子表格上腾出空间让Excel

145
00:08:53,459 --> 00:08:58,019
不是只绘第一栏的图，而是对 整个array的结果绘图。

146
00:08:58,019 --> 00:09:02,399
因此，让我们来看看这会如何。 所以我们要删除正常

147
00:09:02,400 --> 00:09:03,060
版本

148
00:09:03,069 --> 00:09:07,017
和array版本，所以你可以真正地看到差别。

149
00:09:07,017 --> 00:09:10,806
我们把它们舍弃。 在普通版本

150
00:09:10,959 --> 00:09:14,439
如果我们腾出空间给整个阵列

151
00:09:14,440 --> 00:09:18,329
我们放入正常的公式，没有任何反应。 我们只得到

152
00:09:18,329 --> 00:09:23,037
一个结果。 但对于该array版本，如果
我们腾出空间，如果我们给它的空间

153
00:09:23,037 --> 00:09:27,012
然后我们敲敲shift control enter键，
发生的事情是，我们得到

154
00:09:27,012 --> 00:09:31,003
整个结果数组。 现在你看到我们在黑板上

155
00:09:31,003 --> 00:09:32,000
的列表。

156
00:09:32,000 --> 00:09:36,000
我们现在在电子表格有一个列表，因为 我们给了Excel空间

157
00:09:36,000 --> 00:09:39,149
来显示：我有列表，我有这个数组的数据给你，

158
00:09:39,149 --> 00:09:44,699
而不是只是第一個版本的。 另一种选择方式，

159
00:09:44,699 --> 00:09:49,037
我们可以利用array公式来扁平化列表。

160
00:09:49,037 --> 00:09:52,977
通过增加一个函数，使得整个列表成为一个值。 

161
00:09:52,980 --> 00:09:57,023
因此，我们有一个列表

162
00:09:57,023 --> 00:10:00,072
我们可以告诉Excel用列表做些事情。

163
00:10:00,072 --> 00:10:03,752
例如SUM（）的列表中，

164
00:10:03,889 --> 00:10:07,260
在正常的版本，如果我们 对两个范围的交集用

165
00:10:07,260 --> 00:10:08,040
SUM（）

166
00:10:08,048 --> 00:10:13,068
我们就得到-2，因为结果是 -2。
我们在周围添加SUM（），但它

167
00:10:13,069 --> 00:10:14,460
仍然会是-2。

168
00:10:14,460 --> 00:10:19,860
在数组版本中，我们得到了不同的 结果。 看看結果如何，

169
00:10:19,860 --> 00:10:23,440
如果我们在数组版本的公式 输入SUM（）

170
00:10:23,560 --> 00:10:26,649
然后我们得到-5。

171
00:10:26,649 --> 00:10:29,091
因为现在SUM（）函数

172
00:10:29,091 --> 00:10:31,991
已经计算出了这个

173
00:10:32,004 --> 00:10:35,008
由数组公式产生的整个列表。

174
00:10:35,044 --> 00:10:39,984
在这里，你看到了所有的单独的减法的对照组

175
00:10:40,019 --> 00:10:44,579
如果我们添加一个SUM（），我们得到了完全相同的值。

176
00:10:44,589 --> 00:10:48,016
所以所有的独立差集和 SUM（）

177
00:10:48,016 --> 00:10:53,556
导致的结果与数组公式周围的SUM（）的结果一样。

178
00:10:53,960 --> 00:10:57,035
而这方法，是我們如何解决最初

179
00:10:57,035 --> 00:11:00,675
想对所有问题做相互比较的这个疑问。

180
00:11:00,680 --> 00:11:03,736
我们并不需要一个辅柱栏和 一个SUM（）

181
00:11:03,959 --> 00:11:07,439
我们可以在一个单元格计算整个总和，

182
00:11:07,449 --> 00:11:11,189
这为我们节省了大量的空间。 让我们看看結果如何。

183
00:11:12,580 --> 00:11:14,054
我们不再需要SUM（）与辅柱栏了，

184
00:11:14,054 --> 00:11:17,974
我们现在可以用它来只在一个单元格内计算问题1和问题2

185
00:11:18,025 --> 00:11:22,625
之间的区别。 我们用SUM（）函数计算

186
00:11:22,639 --> 00:11:25,651
整个范围，B区

187
00:11:25,759 --> 00:11:29,067
减去C区，再取绝对值

188
00:11:29,067 --> 00:11:33,207
就像我们在一开始做的，然后 按shift回车

189
00:11:33,209 --> 00:11:37,048
就像我们一开始一样得到了21的结果。

190
00:11:37,048 --> 00:11:40,699
用了数组公式，我们仅用了一个单元格就减掉

191
00:11:40,699 --> 00:11:43,959
一列和一个SUM()函数。

192
00:11:44,139 --> 00:11:46,259
这就是数组公式 的好处。
