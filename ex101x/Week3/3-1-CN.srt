1
00:00:00,057 --> 00:00:03,637
你们好，欢迎收看本周的视频。 本周我们将只

2
00:00:04,023 --> 00:00:09,028
讨论数据透视表 ，我猜这么一来大家都可以稍微

3
00:00:09,028 --> 00:00:10,041
放松一下自己了。

4
00:00:10,041 --> 00:00:13,761
因为如果你做了上周的练习， 这很可能

5
00:00:13,929 --> 00:00:18,420
就是你差不多要掌握的东西，所以我估计你们已经

6
00:00:18,420 --> 00:00:20,600
看了一星期新公式了。

7
00:00:20,619 --> 00:00:25,075
那么本周就不学新公式了，我们来讨论下如何

8
00:00:25,075 --> 00:00:27,035
通过数据透视表分析数据。

9
00:00:27,039 --> 00:00:30,859
并且我们不会再继续“五金店”的例子了。

10
00:00:31,023 --> 00:00:34,192
我觉得我们已经做够了关于五金店的例子了，所以这

11
00:00:34,220 --> 00:00:34,960
周

12
00:00:34,969 --> 00:00:39,429
我们即将来经营一个酒吧。 这个关于酒吧的电子表格与

13
00:00:39,429 --> 00:00:42,200
五金店的例子有些相似，因为我们还是

14
00:00:42,280 --> 00:00:46,095
从一记录系统导出，通过该系统保持酒吧所有销售记录的追踪。

16
00:00:46,095 --> 00:00:50,915
但在这个例子里我们有更多信息，因为除了日期、

17
00:00:51,017 --> 00:00:54,617
时间、我们销售的啤酒种类和数量之外，

18
00:00:54,699 --> 00:00:57,879
我们也记录啤酒的买家。

19
00:00:57,949 --> 00:01:01,169
所以让我们假设我们所有的客户都拥有某种会员卡，

20
00:01:01,329 --> 00:01:04,068
这样我们就确切地知道谁在哪一个时间点购买了什么，

21
00:01:04,068 --> 00:01:07,868
并且我们也理所当然可以为此做很多有用的分析。

22
00:01:09,320 --> 00:01:10,680
根据这些数据，

23
00:01:10,900 --> 00:01:14,960
在另外一个工作表格里我们还拥有一个啤酒销售的列表，

24
00:01:15,000 --> 00:01:18,000
所有的啤酒都在那，假设我们用谷歌搜索了

25
00:01:18,001 --> 00:01:21,026
所有的啤酒，并且找到了一个不错的啤酒列表。

26
00:01:21,035 --> 00:01:24,067
由此我们当然可能会问自己这样一个问题：

27
00:01:24,067 --> 00:01:27,907
每个啤酒种类都卖了多少？

28
00:01:28,035 --> 00:01:31,875
于是我们可以使用一个条件统计（COUNTIF）函数来解决这个问题，我敢肯定，这是迄今为止

29
00:01:31,980 --> 00:01:33,078
大家都十分熟悉的一项函数了。

30
00:01:33,078 --> 00:01:37,018
我们在注册记录中查找

31
00:01:37,189 --> 00:01:40,059
购买这一特定种类啤酒的次数？

32
00:01:40,059 --> 00:01:44,639
很简单，对吧？ 你已经知道这一点。 所以问题来了：这个公式

33
00:01:44,659 --> 00:01:50,219
到底正确与否呢？ 你可以发现这个公式有什么不对的地方吗？

34
00:01:50,479 --> 00:01:53,419
我给你一秒钟的时间思考一下。

35
00:01:55,074 --> 00:01:59,714
所以我希望当我停顿的时候，你对着电脑屏幕大声喊出答案，

36
00:02:00,001 --> 00:02:02,033
因为关于这个公式

37
00:02:02,042 --> 00:02:06,762
有几个很明显的错误。 第一件事是，我们并不需要

38
00:02:06,939 --> 00:02:10,067
啤酒的前缀。 如果你在多个工作表格之间切换，

39
00:02:10,067 --> 00:02:13,867
Excel总是会添加前缀，但实际上还是删除它们比较好。

40
00:02:13,980 --> 00:02:18,060

还有其它的一些问题是，我不认为在这里使用条件统计（COUNTIF）函数是

41
00:02:18,069 --> 00:02:18,909
正确的，

42
00:02:19,041 --> 00:02:22,079
因为我们有数量的存在。

43
00:02:22,079 --> 00:02:25,479
而我们使用条件统计（COUNTIF）函数是为了

44
00:02:25,660 --> 00:02:28,940
统计该地方的行数而已。 但这并非我们想要的。

45
00:02:29,014 --> 00:02:32,079
我们想要使用的是条件求和（SUMIF）函数， 因为我们希望得出

46
00:02:32,079 --> 00:02:37,579
我们销售这些数量的总和。 因此，我们必须稍微改变一下

47
00:02:37,680 --> 00:02:38,380
我们的函数，

48
00:02:38,480 --> 00:02:41,860
因为现在我们还需告诉Excel我们

49
00:02:42,002 --> 00:02:45,026
求和的是哪一列的数量。 如果我们添加了那个函数 那么

50
00:02:45,044 --> 00:02:52,844
这个公式就是正确的。 尽管该公式是正确的，但这里还是存在

51
00:02:53,029 --> 00:02:57,086
一些不便， 因为您在此时看到的

52
00:02:57,086 --> 00:02:57,906
纵列

53
00:02:58,044 --> 00:03:01,844
中只包含了零值，因为

54
00:03:02,032 --> 00:03:05,034
我们所能销售的所有啤酒列表都太长了

55
00:03:05,034 --> 00:03:08,874
以至于第一栏没有产生。

56
00:03:09,002 --> 00:03:12,004
所以，我必须点击排序。 我得

57
00:03:12,022 --> 00:03:15,029
到功能栏中单击排序，比如说我只想要

58
00:03:15,092 --> 00:03:19,752
最大的数值位于顶端。 然后正如你所见，

59
00:03:20,006 --> 00:03:24,031
我们可以准确看出我们一直以来卖的是什么种类的啤酒。
所以想要搞定这一切

60
00:03:24,031 --> 00:03:25,491
是相当有难度的。

61
00:03:25,549 --> 00:03:29,001
并且除此之外，我们可以问一个

62
00:03:29,001 --> 00:03:33,038
更有难度的问题， 假设我们的老板被涉及进来，

63
00:03:33,047 --> 00:03:37,807
虽然我们从五金店变成啤酒店，但我们老板还是同一个人，这

64
00:03:38,002 --> 00:03:38,881
是不是有点意思。

65
00:03:39,079 --> 00:03:42,339
她经常问一些很有趣的问题像是：晚上11点以后

66
00:03:42,519 --> 00:03:45,563
什么啤酒最畅销？

67
00:03:45,959 --> 00:03:49,043
这些大概是值得了解一下的，因为你想知道什么啤酒

68
00:03:49,043 --> 00:03:50,072
在傍晚畅销，

69
00:03:50,072 --> 00:03:53,792
什么啤酒在深夜更受欢迎。

70
00:03:54,016 --> 00:03:57,059
因此，假定我们要添加一个像这样的分析

71
00:03:57,059 --> 00:04:01,358
势必有些繁琐。 因为首先我们必须添加

72
00:04:01,360 --> 00:04:02,560
另一纵列，

73
00:04:02,800 --> 00:04:05,840
比如11点以后的什么时间。

74
00:04:05,840 --> 00:04:08,400
你的第一直觉可能就是使用

75
00:04:08,569 --> 00:04:13,048
一个条件（IF）函数，但实际上这没有这个必要。
你只需使用Excel中的一个比较

76
00:04:13,048 --> 00:04:13,968
功能

77
00:04:14,015 --> 00:04:18,784
作为一个适合的公式， 那么在这里我们作

78
00:04:18,919 --> 00:04:23,033
第一次尝试，比方说假如时间大于23时。

79
00:04:23,033 --> 00:04:27,041
然而，这并不真得奏效，
因为你在此看到的例子中，我们使用的时间是

80
00:04:27,041 --> 00:04:28,088
晚上11点。

81
00:04:28,220 --> 00:04:33,740
然而，我们得到的仍然是非正确（FALSE）结论。
其原因是Excel对时间的处理方法

82
00:04:33,740 --> 00:04:35,740
是：把时间

83
00:04:36,052 --> 00:04:42,053
作为一天中所占的分数来保存的。
所以，下午5点在这儿差不多就是0.7。

84
00:04:42,780 --> 00:04:45,846
如果你把时间改成一个数字你就会看见这样的现象。

85
00:04:46,019 --> 00:04:50,498
因此，为了对整体时间作适当的比较，我们需要比较单个时间。

86
00:04:50,669 --> 00:04:55,033
因此我们使用这样一个时间，23小时0分0秒。

87
00:04:55,033 --> 00:04:59,373
如果使用这样来比较，我们在时间大于11的情况下

88
00:04:59,599 --> 00:05:04,097
就能得到正确（TRUE）的结论。 所以我刚刚耍了点手段。
我在视频的开头告訴过你

89
00:05:04,097 --> 00:05:07,977
我不会向你展示任何新的公式。

90
00:05:08,031 --> 00:05:12,260
这是一个新的公式，但我希望你别计较它，

91
00:05:12,539 --> 00:05:14,039
因为它非常简单，而且

92
00:05:14,099 --> 00:05:19,115
仅适用于时间的比较。
因此，有了这个函数，我们现在可以加入我们的分析了，

93
00:05:19,259 --> 00:05:20,013
因为我们可以

94
00:05:20,013 --> 00:05:23,042
从SUMIF（）的销售时间更改

95
00:05:23,159 --> 00:05:27,078
成SUMIFS（），在这里我们使用多重条进行求和。

96
00:05:27,078 --> 00:05:31,058
我们必须稍微改变一下我们的公式，
因为SUMIFS（）使用方法是：

97
00:05:31,065 --> 00:05:34,078
我们先取得求和的纵栏，

98
00:05:34,078 --> 00:05:38,038
然后是条件列表。 因此，我们先选择数量栏，

99
00:05:38,075 --> 00:05:42,575
然后比方说我们希望得到啤酒的名称，

100
00:05:42,580 --> 00:05:46,660
将其作为第一个条件。 它必须等同于啤酒工作表的

101
00:05:46,669 --> 00:05:47,389
第一栏，

102
00:05:47,389 --> 00:05:50,099
然后第二个条件是：

103
00:05:50,099 --> 00:05:55,019
晚上11点以后的时间必须是正确的（TRUE）。

104
00:05:55,082 --> 00:06:01,942
所以这是一个相当长的公式，但它完成了这项任务。
但是，正如你在此看到的，

105
00:06:02,038 --> 00:06:06,858
该纵栏尚未排序，

106
00:06:07,008 --> 00:06:10,013
因为它仍然是按照原来的顺序排列的，因此，如果要将它再次排序，

107
00:06:10,013 --> 00:06:13,232
我们得点击排序。 在这里，你可以 看到

108
00:06:13,349 --> 00:06:18,002
这些值尚未经过适当的排序。 因此，如果我们现在点击排序

109
00:06:18,002 --> 00:06:21,037
会有奇怪的事情发生。 这里你会看见：

110
00:06:21,037 --> 00:06:24,052
嘿，那是不正确的值！ 该链接已再次更新，

111
00:06:24,052 --> 00:06:29,053
这是因为这次我们忘记一件事，

112
00:06:29,062 --> 00:06:33,682
我希望你在电脑屏幕前再次喊出答案 。 我们忘了删除啤酒的

113
00:06:33,720 --> 00:06:35,709
前缀。 所以假如把它删除

114
00:06:35,919 --> 00:06:41,119
我们就会得到正确的结果。 但这会是一项很大的工程吧？

115
00:06:41,389 --> 00:06:45,769
一个简单的疑问：什么啤酒在晚上11点之后卖得最好？

116
00:06:45,919 --> 00:06:48,941
我们必须添加另一纵栏、改变我们的公式

117
00:06:49,139 --> 00:06:52,172
并确保我们不会忘记去掉前缀，

118
00:06:52,340 --> 00:06:57,699
同时不要忘了排序。 因此，我希望你从视频学到的是

119
00:06:57,699 --> 00:07:02,059
公式是用来计算的途径。 如果你要计算

120
00:07:02,219 --> 00:07:05,027
总数或平均数，使用公式是不错的选择。

121
00:07:05,027 --> 00:07:08,787
但一旦你开始真正做起分析，

122
00:07:09,012 --> 00:07:12,421
你将深入数据之中，你会问自己这样一些问题，比如：

123
00:07:12,529 --> 00:07:15,083
星期六最受畅销的啤酒是什么，

124
00:07:15,083 --> 00:07:18,683
如果那时的温度达到了零下？ 诸如此类的问题。

125
00:07:19,012 --> 00:07:23,752
如果你分析的是数据公式时，很快就无法得心应手了。 我认为你

126
00:07:24,001 --> 00:07:25,460
在这个例子中看到，

127
00:07:25,469 --> 00:07:30,005
这样的事情来得很快。 所以请记住，公式不适用于分析

128
00:07:30,005 --> 00:07:33,033
那么究竟什么适合用于分析呢？

129
00:07:33,580 --> 00:07:37,597
是数据透视表 ！ 接下来有更多关于数据透视表的视频 。
