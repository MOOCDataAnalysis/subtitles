1
00:00:01,016 --> 00:00:04,095
你们好，欢迎回来！ 在之前的视频里我向你们解释了

2
00:00:04,095 --> 00:00:07,097
如果你想使用 VLOOKUP，

3
00:00:07,097 --> 00:00:10,997
你就要把FALSE作为 最后一个参数，

4
00:00:11,044 --> 00:00:14,067
因为当你把两张工作表连在一起的情况下，

5
00:00:14,340 --> 00:00:18,320
你想收到当查找结果未能发现时的有关警告信息
但是，在某些情况下，

6
00:00:18,320 --> 00:00:19,740
TRUE这个设置也可以

7
00:00:19,800 --> 00:00:23,015
是不错的选择，而在这个视频我 将会为你们解释

8
00:00:23,015 --> 00:00:27,895
什么时候你必须使用TRUE。 举例来说，
当我们做以下的分析时：

9
00:00:28,008 --> 00:00:32,002
在这张我创建的新的工作表里， 我们将会有详细地解释

10
00:00:32,002 --> 00:00:35,008
如何计算利润率。 譬如你要与你的销售总监会面

11
00:00:35,026 --> 00:00:39,037
他说：“我想了解一下，

12
00:00:39,037 --> 00:00:44,052
我们哪些产品的利润率比较高，

13
00:00:44,052 --> 00:00:44,972
而哪些产品的利润率

14
00:00:45,002 --> 00:00:48,039
有待提高？” 那么首先，

15
00:00:48,039 --> 00:00:51,839
我们将为各个商品代号查看其利润率。 而这一步仅仅只是

16
00:00:52,039 --> 00:00:55,050
使用了传统的VLOOKUP加上FALSE的功能，

17
00:00:55,149 --> 00:00:58,589
我们现在先查看ProductInfo，并返回第六列，

18
00:00:58,880 --> 00:01:01,893
即利润率。 我们来更改它。

19
00:01:02,005 --> 00:01:06,014
再次提醒，不要忘了货币符号，这点十分重要！

20
00:01:06,014 --> 00:01:09,674
之后你把公式往下拖，就可以得出所有的利润了。

21
00:01:09,780 --> 00:01:13,320
接下来，我们在这一步的基础上再进行分析。 现在我们想了解一下

22
00:01:13,500 --> 00:01:16,900
某个利润率究竟是理想还是不理想。 我们可以为此输入一条公式，

23
00:01:17,046 --> 00:01:20,606
那是一条简单的条件公式，

24
00:01:20,606 --> 00:01:21,740
就像我们在之前的视频介绍过的一样。

25
00:01:21,760 --> 00:01:24,760
如果我们的利润率，譬如说，

26
00:01:24,760 --> 00:01:30,960
小于20％，那么它是不理想的。 如果它大于20％，

27
00:01:30,960 --> 00:01:33,080
但仍小于30%，

28
00:01:33,086 --> 00:01:37,986
我们就说这个利润率还过得去， 而如果利润率在30%以上，

29
00:01:38,039 --> 00:01:41,899
那么我们会说这款产品的利润率十分理想。

30
00:01:42,013 --> 00:01:45,006
的确，我们可以用 条件公式 来做到这一点，

31
00:01:45,006 --> 00:01:48,526
只需将公式拉下来

32
00:01:48,729 --> 00:01:52,013
就行了 这种方法没有什么不对，可是

33
00:01:52,013 --> 00:01:56,039
我们在这里嵌套了好几个不同的条件。还记得以前的视频提到过的吗？

34
00:01:56,039 --> 00:02:00,359
如果你嵌套了过多的条件语句，公式可能会变得

35
00:02:00,440 --> 00:02:01,690
过于复杂。

36
00:02:02,160 --> 00:02:06,020
很多人可能不会想到，这 种情况

37
00:02:06,038 --> 00:02:09,257
其实我们可以好好利用VLOOKUP这个功能。
它跟之前我们说过的查找多张工作表中的

38
00:02:09,400 --> 00:02:12,078
某个数值不大一样，但VLOOKUP的确可以

39
00:02:12,078 --> 00:02:16,998
在这里派上用场，请留意我接下来是怎么做的。 我们在这里要做的是

40
00:02:17,024 --> 00:02:21,524
在添加工作表分类的地方，再加入一个表格。

41
00:02:21,700 --> 00:02:24,960
我们来设定：

42
00:02:25,048 --> 00:02:28,768
利润率小于零为不理想的，

43
00:02:29,038 --> 00:02:32,198
零到20之间的为普通

44
00:02:32,300 --> 00:02:36,900
而高于20，即是20到30之间，

45
00:02:37,035 --> 00:02:41,335
则是理想的。 这个分类正是与我们输入

46
00:02:41,500 --> 00:02:44,900
条件公式 时是一样的。 现在，我们就可以

47
00:02:45,022 --> 00:02:48,822
去掉整个IF语句了， 因为我们并不喜欢这个镶嵌的IF语句，

48
00:02:49,008 --> 00:02:52,019
然后把VLOOKUP放进那里。 我们要找出

49
00:02:52,019 --> 00:02:55,068
在这个新的利润率表格里，利润率的数值是多少

50
00:02:55,160 --> 00:02:58,680
让我们回到第二 列

51
00:02:58,709 --> 00:03:03,041
然后把TRUE加上去， 我们并不能查找“22”，

52
00:03:03,041 --> 00:03:06,072
因为"22"并不在在表中。 我们只想

53
00:03:06,072 --> 00:03:10,072
找出最接近22的利润率。

54
00:03:10,200 --> 00:03:13,420
看到了吧，这时VLOOKUP的功能

55
00:03:13,420 --> 00:03:16,660
是与IF的功能完全一样的。

56
00:03:17,140 --> 00:03:20,980
这种方法其实是十分简单的，因为如果你想改变

57
00:03:21,000 --> 00:03:23,540
表格里的一个数值，像你刚才看到的

58
00:03:23,700 --> 00:03:26,777
我把ok改为大写的OK。 我可以直接在

59
00:03:27,011 --> 00:03:30,054
表格里改，并不需要改变 公式，

60
00:03:30,054 --> 00:03:33,894
一但我在表格里改变某个内容，所有的公式会被立即更新。
不仅如此，

61
00:03:34,026 --> 00:03:37,084
如果我想添加其他的分类， 例如我想把40％

62
00:03:37,084 --> 00:03:41,089
添加到利润率的最佳值，我可以 先把它添加到表格上

63
00:03:41,089 --> 00:03:45,809
再更新的查找列表的内容，然后公式中的条件就会被更新了。

64
00:03:46,009 --> 00:03:49,438
反之，如果我用的是IF，我就要另外

65
00:03:49,519 --> 00:03:54,038
为IF添加另一个分支命令，那么我的公式就变得越来越长了，

66
00:03:54,038 --> 00:03:57,698
而有了这个VLOOKUP，无论有多少分类

67
00:03:57,900 --> 00:04:01,719
都不要紧。 如果我有一百个分类，这个公式 依然只有一个

68
00:04:01,769 --> 00:04:04,649
VLOOKUP，可是如果我

69
00:04:04,740 --> 00:04:07,940
用的是条件公式 ，那么我的公式里将会有一百个IF。

70
00:04:08,022 --> 00:04:11,942
其实严格来说只有99个IF，但是这仍然是太多了。

71
00:04:11,980 --> 00:04:17,008
所以说，当你要进行分类，即是当你要把一个数值

72
00:04:17,018 --> 00:04:20,043
用IF语句来分成不同类别

73
00:04:20,043 --> 00:04:24,083
那么我希望大家记住这点：

74
00:04:24,083 --> 00:04:25,020
你可以使用填入TRUE作为参数的VLOOKUP

75
00:04:25,021 --> 00:04:29,161
来大幅度简化公式。
